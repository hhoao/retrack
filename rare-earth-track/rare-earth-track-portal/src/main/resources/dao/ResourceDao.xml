<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.rare_earth_track.dao.ResourceDao">
    <resultMap id="resource" type="com.demo.rare_earth_track.bean.Resource">
        <result property="id" column="resourceId"/>
        <result property="createTime" column="resourceCreateTime"/>
        <result property="description" column="resourceDescription"/>
        <result property="url" column="resourceUrl"/>
        <result property="name" column="resourceName"/>
    </resultMap>
    <select id="getAllResources" resultType="com.demo.rare_earth_track.bean.Resource">
        select * from resource;
    </select>

    <select id="getResourcesByUserId" resultMap="resource">
        SELECT a.method resourceMethod, a.create_time resourceCreateTime, a.description resourceDescription, a.url resourceDescription, a.id resourceId, a.name resourceName
        FROM resource a,
             (
                 SELECT t.id,t.name, t.sex, t.password,t.birthday,t.address, a_r.resource_id
                 FROM resource_role a_r,
                      (
                          SELECT id, t.name, t.sex, t.password,t.birthday,t.address
                          FROM user_role u_r,
                               (SELECT id, name, sex, password,birthday,address FROM user where name = 'user1') t
                          WHERE t.id = u_r.user_id) t
                 WHERE t.id = a_r.role_id
             ) t
        WHERE t.id = a.id;
    </select>
</mapper>